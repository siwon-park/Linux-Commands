# 14_sed 명령어

## 1. sed

> sed; streamlined editor

vi, vim 편집기와 같은 편집을 위한 명령어.

단 vi와 vim은 편집기를 열어서 화면과 상호작용하는 대화형 방식인 반면에, sed는 명령행에서 파일을 인자로 받아 명령어를 통해 작업한 후 결과를 직접 화면으로 확인하는 방식으로 작업을 진행한다는 점에서 차이가 있다.

sed는 특정 옵션이나 쉘 리다이렉션(`>`)을 이용해 편집 결과를 저장하기 전까지는 파일에 아무런 변경을 가하지 않는다.
따라서 명령 수행 후 출력 결과가 원본과 다르더라도 원본에 손해가 없다.

## 2. sed 워크 스페이스

![image](https://github.com/siwon-park/Linux-Commands/assets/93081720/b7b044c0-8246-4a7c-bdb5-8a3c3cc36d7a)

### 1) 패턴 스페이스 (패턴 버퍼)

sed 명령어를 통해 파일을 줄(라인) 단위로 읽어온 데이터가 임시적으로 저장되는 공간이다.

sed 명령어를 통해 내용 조작이나 출력을 수행하면 패턴 버퍼의 내용이 사용된다.

### 2) 홀드 스페이스 (홀드 버퍼)

패턴 버퍼보다 데이터를 좀 더 긴 시간 동안 저장하고 있는 임시 저장 공간

이전에 작업하던 데이터를 기억 가능해서, 어떤 내용을 홀드 버퍼에 저장하면 sed가 다음 행을 읽는 중이더라도 원할 때 다시 불러와 데이터를 재사용할 수 있다.

## 3. sed 명령어

```bash
sed [옵션] [정규식 혹은 메타문자] [파일명]
```

- 옵션
  - `-e`: 조건식 스크립트를 지정
  - `-f`: 조건식 스크립트가 기재된 파일을 지정
  - `-n`: 패턴이 일치하는 라인만 출력
  - `-r`: 확장 정규표현을 사용한 스크립트 사용
  - `-i`: 수정된 내용으로 파일 덮어쓰기

- subcommand

- 치환 플래그

### 1) 사용 예시

```bash
# 8행부터 끝까지 출력
sed -n '8,$p' test.txt

# '#'으로 시작하는 코멘트 행 삭제
sed '/^#/d' test.txt

# 빈 행 삭제
sed '/^$/d' test.txt

# 15행부터 26행까지(둘 다 포함) 삭제한 후 새로운 파일로 저장
sed '15,26d' test1.txt > test2.txt

# 모든 'redis' 문자를 '레디스'로 치환
sed -e 's/redis/레디스/g' test.txt

# 대소문자 구분하지 않고 모든 'redis' 문자를 '레디스'로 치환
sed -e 's/redis/레디스/gi' test.txt

# 파일의 마지막에 내용 추가하고 기존 내용(원본) 덮어쓰기
sed -i '$a추가할내용' test.txt

# 탭을 스페이스로 변환
sed -e 's/탭/스페이스/g' test.txt
# ※ 탭: \t, 스페이스: (공백 1번)

# 파일 내용의 모든 줄마다 특정 문자(abc)를 추가 후 저장
sed -i 's/$/abc/' test.txt
```