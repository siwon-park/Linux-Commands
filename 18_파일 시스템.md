# 18_파일 시스템

> 리눅스 파일 시스템

파일 시스템(File System)? 파일과 디렉토리의 집합을 구조적으로 관리하는 체계.

사용자 영역이 아닌 커널 영역에서 동작하는 시스템.

## 1. 리눅스 파일 시스템

### 1) 특징

- 단일 트리 구조
  - 하나의 root 디렉토리가 있고, 디렉토리 - 하위 디렉토리 - 데이터 파일로 구성됨
- 모든 것이 다 파일
  - 하드웨어 장치, 프로세스, 파일, 디렉토리 등 전부 다 파일임
  - 파일 형태로 되어있기 때문에 어떤 동작을 할 때 조작이 쉬움
- 파일은 inode라는 개념으로 관리한다.
  - inode; index node를 의미하며 리눅스, 유닉스 파일 시스템에서 파일에 대한 메타 데이터(파일 속성 및 디스크 블록 정보 등)를 저장하는 데이터 구조체
  - 각 파일과 디렉토리는 고유한 inode를 가지고 있다.

<br>

### 2) 파일 시스템과 디렉토리 계층 구조

![image](https://github.com/siwon-park/Linux-Commands/assets/93081720/20f6e64b-1cd1-42de-9b45-f32ac27ebb9d)

<br>

### 3) 파일 시스템 생성

파티션을 먼저 나누고 파일 시스템을 만들어야 한다. 파티션을 나누지 않을 경우 바로 파일 시스템을 만들어도 된다.

#### (1) 파일 시스템 종류

리눅스에는 다양한 파일 시스템 유형이 존재하는데, ext4, XFS, nfs, ntfs, sysv, swap, tmpfs, proc 등이 있다.

#### (2) 파일 시스템 생성 명령어

```bash
mkfs [옵션] [장치명] # 리눅스 파일 시스템 생성 (default: ext2)

mke2fs [옵션] [장치명] # 리눅스 개정판 확장 파일 시스템(ext2, ext3, ext4) 생성 (default: ext2)
```

- 옵션
  - `-t`: 파일 시스템 종류
  - `-b`: 블록 크기 (byte)
  - `-c`: 배드 블록 체크
  - `-f`: 프레그먼트 크기 (byte)
  - `-i`: inode당 byte 수
  - `-m`: 퍼센트 수
- 예시
  - ext2 파일 시스템 생성: mke2fs /dev/hdb1
  - ext3 파일 시스템 생성: mkfs.ext3 /dev/hdb2
  - swap 파일 시스템 생성: mkswap /dev/hdb3

<br>

## 2. 파티션 (partition)

> 하나의 디스크 공간을 독립적인 영역으로 분할하는 것

![image](https://github.com/siwon-park/Linux-Commands/assets/93081720/7c8023b4-4c11-42fb-a396-d1ad3be515ee)

### 1) 파티션의 목적

- 디스크의 공간의 효율적인 사용
  - 필요에 따라 디스크 공간을 효율적으로 할당하여 사용 가능
  - 파티션을 분리하지 않을 경우 전체 저장 장치의 파일 시스템이 손상되면 백업이 불가능한 반면, 파티션을 나눠서 파일 시스템을 구분해놓으면 문제가 있는 파티션의 파일 시스템만 손상이 있기 때문에 전체 디스크 손상의 위험 방지 가능
- 운영체제 설치 공간과 데이터 저장 공간의 분리
  - 운영체제와 데이터의 공간을 분리하여, 운영체제를 재설치하거나 업데이트할 때 운영체제의 파티션만 작업하면 되기 때문에 데이터를 안전하게 보호 가능
- 파티션별로 서로 다른 파일 시스템을 사용하기 위함
  - 파일 시스템별 특징과 용도가 있기 때문에 파티션을 나눠서 서로 다른 파일 시스템을 적용하기 위해 나누기도 함
- 백업 및 복구 용이
  - 개별 파티션을 백업/복구하기가 더 쉽고 빨리 끝남
  - 중요한 데이터가 있는 파티션만 선택적으로 백업 가능
- 보안
  - 중요한 시스템 파일을 별도 파티션에만 보관하고 접근을 제어함으로써 보안적인 목적을 달성 가능

<br>

### 2) 네이밍 기준

장치 파일의 경우 IDE 디스크는 `/dev/hd-`, SCSI 디스크의 경우 `/dev/sd-`로 시작한다.

장치 파일이 여러 개일 경우 a ~ z까지의 알파벳을 부여한다.

- 예) /dev/hda, /dev/hdb, ... 또는 /dev/sda, /dev/sdb, ...

각 디스크를 파티션을 나누게 되면 맨 뒤에 숫자를 붙이는 방식으로 네이밍 규칙이 정해져있다.

- 예) /dev/sda를 3개의 파티션으로 나눔 =>  /dev/sda1, /dev/sda2,  /dev/sda3

<br>

### 3) 파티션 확인

#### (1) fdisk

fdisk [옵션] [장치명]을 통해서 장치명의 파티션 정보를 확인할 수 있다.

fdisk -l을 입력하면 파티션 정보를 리스트로 쭉 출력해서 확인 가능하다.

#### (2) df

df -h를 통해서 파일 시스템별 크기, 사용량, 마운트 정보 등을 확인할 수 있다.

#### (3) /etc/fstab

cat /etc/fstab 혹은 vim /etc/fstab을 통해서 모든 파티션에 대한 정보를 확인할 수 있다.
